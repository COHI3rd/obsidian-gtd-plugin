# GTD Task Manager for Obsidian

Notion風のドラッグ&ドロップUIで快適なGTD（Getting Things Done）タスク管理を実現するObsidianプラグインです。

![GTD Plugin](https://img.shields.io/badge/version-0.1.0-blue)
![Obsidian](https://img.shields.io/badge/obsidian-v1.0.0+-purple)
![License](https://img.shields.io/badge/license-MIT-green)

## ✨ 特徴

### コアGTD機能
- 📥 **Inbox システム** - 思いついたことを即座に記録
- 🎯 **GTDワークフロー** - Inbox → 次に取るべき行動 → Today の流れを完全サポート
- 🖱️ **ドラッグ&ドロップ** - 直感的なタスク移動・手動並び替え
- 📅 **日付自動入力** - Todayにドラッグすると自動で今日の日付を設定
- 🔄 **自動日付更新** - 前日から残ったタスクを自動で翌日のTodayに更新
- ✅ **完了タスク自動整理** - 完了タスクは常にリストの下部に表示
- 🗑️ **ゴミ箱機能** - タスクをドラッグ&ドロップで削除（ゴミ箱フォルダに移動）
- 🔄 **ビュー切り替え** - ドロップダウンから簡単にビューを切り替え
- 🕛 **日付変更自動検知** - アプリを開いたまま日付が変わると自動で全ビューを更新（1分ごとにチェック）

### プロジェクト&レビュー
- 📊 **プロジェクト管理** - 進捗率の自動計算、重要度・期限管理
- 🎯 **プロジェクト一覧ビュー** - ギャラリー形式でプロジェクトを管理
  - 統計サマリー表示（未開始・進行中）
  - ビューから直接プロジェクト作成
  - 📂 プロジェクトカード展開機能 - クリックでタスク一覧を表示（デフォルト: 閉じた状態）
- 📋 **週次レビュービュー** - GTDの週次レビューをサポート
  - ✅ 今週完了したタスクの振り返り（ビューを開くと自動更新）
  - いつかやる/多分やるリストの整理
  - 連絡待ちタスクの確認
  - 進行中プロジェクトの見直し
- 🔗 **タスク作成時にプロジェクト選択** - 新規タスク作成時にプロジェクトを関連付け

### ユーザー体験
- 🎉 **オンボーディング** - 初回起動時のウェルカムガイド
- 📦 **サンプルデータ** - すぐに使い方を学べるサンプル
- ⚠️ **エラーハンドリング** - わかりやすいエラーメッセージ
- ⚡ **パフォーマンス最適化** - React.memoとuseMemoで高速化
- 📝 **デイリーノート連携** - 完了タスクをDataviewで自動集計
- 🔽 **グループ開閉機能** - 各タスクグループを折りたたんで整理
- 📱 **レスポンシブ対応** - 幅に応じて最適なレイアウトに自動調整（450px境界）
- 📏 **リサイズ可能パネル** - 1列レイアウト時にToday/その他セクションの高さを調整可能
- 🖱️ **右クリックメニュー** - タスクを右クリックでステータスを素早く変更
- 🔄 **ビュー切り替え** - アイコンボタンでタスク/プロジェクト/週次レビュー間を素早く切り替え
- 🔄 **手動更新機能** - 各ビューに🔄ボタン設置、コマンドパレットから「すべてのビューを更新」も実行可能

### データ管理
- 🇯🇵 **完全日本語対応** - すべてのUIが日本語
- 📝 **Markdown完全対応** - データはすべてMarkdownファイル
- 🔗 **バックリンク連携** - Obsidianの機能と完全統合

## 🚀 インストール

### コミュニティプラグインから（推奨）

1. Obsidianの設定を開く
2. 「コミュニティプラグイン」→「閲覧」
3. 「GTD Task Manager」を検索
4. 「インストール」→「有効化」

### 手動インストール

1. [最新リリース](https://github.com/yourusername/obsidian-gtd-plugin/releases)から`main.js`、`manifest.json`、`styles.css`をダウンロード
2. Vaultの`.obsidian/plugins/obsidian-gtd-plugin/`フォルダに配置
3. Obsidianを再起動してプラグインを有効化

### 開発版

```bash
cd /path/to/your/vault/.obsidian/plugins
git clone https://github.com/yourusername/obsidian-gtd-plugin.git
cd obsidian-gtd-plugin
npm install
npm run dev
```

## 📖 使い方

### 基本的なワークフロー

1. **タスクを追加**
   - リボンアイコンまたはコマンドパレット（`Ctrl/Cmd + P`）から「GTDビューを開く」
   - 「+ タスクを追加」ボタンまたは`Ctrl/Cmd + Shift + A`でクイック追加

2. **Inboxを整理**
   - Inboxに追加されたタスクを確認
   - ドラッグ&ドロップで「次に取るべき行動」に移動

3. **今日のタスクを決める**
   - 「次に取るべき行動」から今日やるタスクを選択
   - 「Today」エリアにドラッグ&ドロップ
   - 日付が自動で今日に設定される

4. **タスクを実行**
   - Todayのタスクを上から順に実行
   - 完了したらチェックボックスをオン
   - 完了したタスクは自動的にリストの下部に移動

5. **翌日への引き継ぎ**
   - 前日に完了できなかったTodayタスクは、翌日自動的に今日の日付に更新される
   - 完了済みタスクは`GTD/tasks/完了/YYYY-MM-DD/`フォルダに自動整理

### プロジェクト管理

1. **プロジェクトを作成**
   - `GTD/Projects`フォルダに新しいMarkdownファイルを作成
   - フロントマターに以下を記述:

```yaml
---
type: project
title: プロジェクト名
importance: 3  # 1-5
deadline: 2025-12-31
status: not-started
action-plan: |
  - ステップ1
  - ステップ2
progress: 0
---
```

2. **タスクをプロジェクトに関連付け**
   - タスクファイルのフロントマターに`project: [[プロジェクト名]]`を追加
   - 進捗率が自動で計算される

3. **プロジェクト一覧を開く**
   - コマンドパレットから「プロジェクト一覧を開く」を実行
   - すべてのプロジェクトをギャラリー形式で確認
   - フィルター（ステータス別）やソート（重要度・期限・進捗率）が可能
   - 「新規プロジェクト」ボタンから新しいプロジェクトを作成

### 週次レビュー

GTDの重要なプロセスである週次レビューを専用ビューでサポート：

1. **週次レビューを開く**
   - コマンドパレットから「週次レビューを開く」を実行
   - ビュー切り替えドロップダウンから「🔍 週次レビュー」を選択

2. **今週完了したタスクタブ** ✨NEW
   - 過去7日間に完了したタスクを自動集計
   - 週の振り返りと達成感の確認
   - 完了したタスクをクリックして詳細を確認

3. **いつかやる/多分やるタブ**
   - 将来やりたいタスクを見直す
   - 今週実行すべきタスクを「次に取るべき行動」に移動
   - 不要なタスクはアーカイブ

4. **連絡待ちタブ**
   - 他者に依頼中のタスクを確認
   - 返答があったタスクを「次に取るべき行動」に移動

5. **進行中プロジェクトタブ**
   - 各プロジェクトの進捗を確認
   - 次のアクションが明確か確認
   - プロジェクトカードをクリックしてファイルを開く

### 手動並び替えと自動ソート

設定で2つのソートモードを切り替え可能：

- **手動並び替えモード**（デフォルト）
  - 同じグループ内でドラッグ&ドロップして順序を変更
  - 設定した順序がファイルに保存される

- **自動並び替えモード**
  - 優先度（高→中→低）で自動ソート
  - 同じ優先度なら日付順

**注意**: どちらのモードでも完了タスクは常にリストの下部に表示されます。

### グループの開閉

各グループ（Today、Inbox、次に取るべき行動など）のタイトルをクリックすると、グループを折りたたんだり展開したりできます。

### 右クリックメニュー

タスクを右クリックすると、コンテキストメニューからステータスを素早く変更できます：
- 📥 Inbox
- ⚡ Next Action
- 📅 Today
- ⏳ Waiting
- 💡 Someday
- 🗑️ Trash

### リサイズ可能パネル

1列レイアウト（幅450px以下）では、TodayとOtherセクション間のドラッグハンドルをマウスで上下にドラッグして、表示領域の高さを調整できます。

### ビューの更新

タスクリストを最新の状態に更新する方法が3つあります：

1. **自動更新（日付変更検知）**
   - Obsidianを開いたまま日付が変わると自動的に全ビューが更新されます
   - バックグラウンドで1分ごとに日付をチェック
   - 「Today」タスクが常に正しく表示されます

2. **手動更新（UIボタン）**
   - 各ビュー（GTDメイン、週次レビュー、プロジェクト）のヘッダーにある🔄ボタンをクリック
   - クリックしたビューのデータが即座に更新されます

3. **手動更新（コマンド）**
   - コマンドパレット（`Ctrl/Cmd + P`）を開く
   - 「すべてのビューを更新」を実行
   - 開いている全ビューが一括で更新されます

### デイリーノート連携

完了したタスクを自動的にデイリーノートで参照できます。

#### 方法1: Dataviewプラグインを使用（推奨）

1. **Dataviewプラグインをインストール**
   - 設定 → コミュニティプラグイン → 「Dataview」を検索してインストール

2. **デイリーノートテンプレートに追加**

   デイリーノートのテンプレートファイルに以下を追記：

   ```markdown
   ## 📋 今日完了したタスク

   \`\`\`dataview
   TABLE WITHOUT ID
     file.link as "タスク",
     priority as "優先度",
     project as "プロジェクト"
   FROM "GTD/tasks/完了/{{date:YYYY-MM-DD}}"
   WHERE completed = true
   SORT priority DESC
   \`\`\`
   ```

3. **日付フォーマットの調整**

   デイリーノートの日付フォーマットが`YYYY-MM-DD`と異なる場合は、クエリ内の`{{date:YYYY-MM-DD}}`を調整してください。

   例：`YYYY年MM月DD日`形式の場合
   ```markdown
   FROM "GTD/tasks/完了/{{date:YYYY}}-{{date:MM}}-{{date:DD}}"
   ```

#### 方法2: ボタンから手動挿入

1. GTDビューのヘッダーにある「📝 デイリーノートに反映」ボタンをクリック
2. 今日完了したタスクが現在のデイリーノートに挿入されます

#### 方法3: 手動で確認

完了したタスクは以下のフォルダに日付ごとに整理されます：

```
GTD/tasks/完了/
├── 2025-10-30/
│   ├── タスク1.md
│   └── タスク2.md
├── 2025-10-31/
│   ├── タスク3.md
│   └── タスク4.md
```

デイリーノートから`[[GTD/tasks/完了/2025-10-30]]`のようにリンクを貼ることで、その日完了したタスクのフォルダにアクセスできます。

## ⚙️ 設定

設定画面（`設定` → `GTD Task Manager`）で以下をカスタマイズできます:

- **タスクフォルダ**: タスクファイルの保存場所（デフォルト: `GTD/Tasks`）
- **プロジェクトフォルダ**: プロジェクトファイルの保存場所（デフォルト: `GTD/Projects`）
- **週次レビューフォルダ**: レビューファイルの保存場所（デフォルト: `GTD/Reviews`）
- **日付フォーマット**: 日付の表示形式（デフォルト: `yyyy-MM-dd`）
- **自動日付入力**: Todayへのドラッグ時に自動で日付設定（デフォルト: ON）
- **デフォルト優先度**: 新規タスクの優先度（デフォルト: 中）
- **タスク並び替えモード**: 手動/自動を切り替え（デフォルト: 手動）
- **デイリーノート連携モード**: なし/自動書き込み/Dataview/コマンド（デフォルト: コマンド）
- **デイリーノートフォルダ**: デイリーノートの保存場所
- **デイリーノート日付フォーマット**: デイリーノートのファイル名形式（デフォルト: `YYYY-MM-DD`）
  - `YYYY-MM-DD`、`yyyy-MM-dd`、`YYYY年MM月DD日`など、どの形式でも対応

## 🎨 データ構造

### タスクファイル

```yaml
---
title: タスク名
status: inbox  # inbox | next-action | today | waiting | someday | trash
project: [[プロジェクト名]]
date: 2025-10-30
completed: false
priority: medium  # low | medium | high
tags: [タグ1, タグ2]
notes: メモ
order: 0  # 手動並び替え用の順序番号
---

ここに詳細な内容を記述
```

### プロジェクトファイル

```yaml
---
type: project
title: プロジェクト名
importance: 3
deadline: 2025-12-31
status: in-progress
action-plan: |
  - アクションプラン
progress: 0
---
```

## 🔧 開発

### 必要要件

- Node.js 18.x以上
- npm 9.x以上

### セットアップ

```bash
git clone https://github.com/yourusername/obsidian-gtd-plugin.git
cd obsidian-gtd-plugin
npm install
```

### 開発モード

```bash
npm run dev
```

### ビルド

```bash
npm run build
```

### テスト

```bash
npm test
npm run test:coverage
```

## 📝 設計思想

このプラグインは以下の設計原則に基づいています:

1. **タスクが親プロジェクトを持つ（B案）**
   - プロジェクトは子タスクのリストを持たない
   - タスクが`project: [[プロジェクト名]]`でプロジェクトを参照
   - 編集が1ファイルで完結し、データの整合性が保たれる

2. **statusとcompletedの役割分担**
   - `status`: GTDワークフロー上の位置（inbox/next-action/today/waiting/someday）
   - `completed`: タスクの完了状態（true/false）
   - 進捗率計算は`completed`のみを使用

3. **Obsidianの哲学に沿った設計**
   - Markdown First
   - リンク駆動
   - バックリンク活用
   - プレーンテキスト

詳細は[要件定義書](../要件定義書.md)と[実装計画](../実装計画.md)を参照してください。

## 🤝 コントリビューション

貢献は大歓迎です！以下の手順でお願いします:

1. このリポジトリをフォーク
2. フィーチャーブランチを作成（`git checkout -b feature/amazing-feature`）
3. 変更をコミット（`git commit -m 'feat: Add amazing feature'`）
4. ブランチにプッシュ（`git push origin feature/amazing-feature`）
5. プルリクエストを作成

コミットメッセージは[Conventional Commits](https://www.conventionalcommits.org/)に従ってください。

## 📄 ライセンス

MIT License - 詳細は[LICENSE](LICENSE)を参照してください。

## 🙏 謝辞

- [Obsidian](https://obsidian.md/) - 素晴らしいノートアプリ
- [GTD（Getting Things Done）](https://gettingthingsdone.com/) - デビッド・アレン氏の生産性手法
- [Notion](https://www.notion.so/) - UIインスピレーション
- [円谷氏のGTD動画](https://www.youtube.com/watch?v=G82JLeUs4NM) - 実装の参考

## 📧 サポート

- 🐛 バグ報告: [Issues](https://github.com/yourusername/obsidian-gtd-plugin/issues)
- 💡 機能リクエスト: [Discussions](https://github.com/yourusername/obsidian-gtd-plugin/discussions)
- 📖 ドキュメント: [Wiki](https://github.com/yourusername/obsidian-gtd-plugin/wiki)

---

**Made with ❤️ for the Obsidian community**
